<!DOCTYPE html>
<html lang="en">
<head>
  <title>customer_followup_page</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
  <link href="https://fonts.googleapis.com/css?family=Poppins" rel="stylesheet">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pretty-checkbox@3.0/dist/pretty-checkbox.min.css"/>
  <link rel="stylesheet" href="../static/css/my_style.css">
	<script type="text/javascript" src="/static/js/aquaguardTimer.js"></script>
<style>
.call-card 
{
	position: absolute;
	height: 280px;
	width: 160px;
	margin-top: 1vh;
	border-radius:20px;
	background: -webkit-linear-gradient(top,#8bf1f8,#00c3ca);
}
.call-user-icon img 
{
	background-color: white;
	border-radius: 50%;
	width: 24%;
}
.call-card-user-name 
{
	position: relative;
	text-align: center;
}
.caller-name 
{
	font-family: poppins;
	font-size: 22px;
	color:black;
	font-weight: bold;
}</style>
</head>
<body>

<nav class="navbar">
	<div class="container">
		<a href="upload_dp.html"><img src="/static/images/Avatar.png" class="user"/></a>
				<p id="loginTime" class="logintime"></p><br>
				<p id="loginDate" class="logindate"></p>
				<h1 class="username">Hello Diana Johns</h1>
	</div>
	
</nav>
<div class="container-fluid">
	<div class="row">
		<div class="col-lg-11">
			<h1 class="dashboard">Your dashboard</h1>
		</div>
		
		<div class="col-lg-1">
		<i class="glyphicon glyphicon-menu-hamburger"style="color:#7CB9E8;font-size:35px;"id="menubar"></i>
		</div>
	</div>
</div><br>
<span class="iconbox">
	<p><a href="">Print Salary slip</a>
		<br>
		<a href="change_password.html">Change Password</a>
		<br>
		<a href="report_an_issue.html">Report an issue</a>
		<button style="font-size:50px;margin-top:-15vh;" class="close" aria-label="Close">
			<span aria-hidden="true">&times;</span>
		</button>
	</p>
</span>

<div class="container">
	<div class="row">
		<div class="col-lg-2 text-center">
			<a href="call_histroy.html"><button type="button">&nbsp;&nbsp;&nbsp;Calls&nbsp;&nbsp;&nbsp;&nbsp;</button></a>
		</div>
		<div class="col-lg-8">
			<div class="progress">
					<div class="progress-bar" role="progressbar" aria-valuenow="17" aria-valuemin="0" aria-valuemax="100">
					</div>
				</div>
		</div>
		<div class="col-lg-2">
			<span id="ID28">28/30</span>
		</div>
	</div>
	<div class="row">
		<div class="col-lg-2 text-center">
			<a href="commits_board.html"><button type="button">Commits&nbsp;</button></a>
		</div>
		<div class="col-lg-8">
			<div class="progress">
					<div class="progress-bar" role="progressbar" aria-valuenow="17" aria-valuemin="0" aria-valuemax="100">
					</div>
				</div>
		</div>
		<div class="col-lg-2">
			<span id="ID28">16/30</span>
		</div>
	</div>
</div>
<br>
<div class="container">
	<div class="row">
		<div class="col-lg-4">
			<a href=""><span id="leadlist">Leads</span></a>
		</div>
		
		<div class="col-lg-6 text-right">
			<a href="after_change_dp.html"><span id="leadlist">Announcement</span></a>
		</div>
	</div>
</div>

<div class="container ">
	<div class="row">
		<div class="col-lg-10">
			<div id="table-scroll" class="table-scroll">
				<div id="faux-table" class="faux-table" aria="hidden"></div>
					<div class="table-wrap scrollbar-ripe-malinka">
						<table id="main-table" class="main-table">
						</table> 
						
						</div>
					</div>
				</div>

				<div class="col-lg-1 text-left">
					<div class="call-card">
							<div class="call-user-icon">
								<center>
									<img class="call-user-icon" src="/static/images/call-user-icon.png">
								</center>
							</div>
							<div class="call-card-user-name">
								<p class="caller-name">Joel Matts</p>
								<p class="caller-id">CUST ID 0023493111834</p>
								<p id="call-duration">01:29:43</p>
							</div>
							<center>
								<div class="single-call-icon">
									<a href=""id="calldisconnect"><img src="/static/images/red-call-icon.png" height="80px" width="80px"></a>
								</div>
							</center>
						</div>
				</div>


			</div>
</div>

<div class="modal fade" id="myModal" role="dialog">
    <div class="modal-dialog">
    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title">
			<div class="container">
				<div class="row">
					<div class="col-lg-6">
						<p style="color:#06BBE1;">LEAD ID: AQ023</p><p style="margin-left:60%;margin-top:-5vh;color:#06BBE1;">LEAD PH: 9900652507</p>
						
					</div>
				</div>
			</div>
		  </h4>
        </div>
        <div class="modal-body">
		<div class="container">  
			<div class="row">
				<div class="col-lg-2">
					<p>First Name</p>
				</div>
				<div class="col-lg-5">
					<input type="text"class="modelname"/>
			    </div>
			</div>
			<div class="row">
				<div class="col-lg-2">
					<p>Last Name</p>
				</div>
				<div class="col-lg-5">
					<input type="text"class="modelname"/>
			    </div>
			</div>
			<div class="row">
				<div class="col-lg-2">
					<p>Alternative number</p>
				</div>
				<div class="col-lg-5">
					<input type="text"class="modelname"/>
			    </div>
			</div>
			<div class="row">
				<div class="col-lg-2">
					<p>City</p>
				</div>
				<div class="col-lg-5">
					<input type="text"class="modelname"/>
			    </div>
			</div>
			<div class="row">
				<div class="col-lg-2">
					<p>PIN</p>
				</div>
				<div class="col-lg-5">
					<input type="text"class="modelname"/>
			    </div>
			</div>
			<div class="row">
				<div class="col-lg-2">
					<p>Address</p>
				</div>
				<div class="col-lg-5">
					<textarea class="modelname"></textarea>
			    </div>
			</div>
			<div class="row">
				<div class="col-lg-2">
					<p>Remarks</p>
				</div>
				<div class="col-lg-5">
					<textarea class="modelname"></textarea>
			    </div>
			</div>
		</div>
        <div class="modal-footer">
			<button type="button" class="btn btn-default" data-dismiss="modal">Update</button>  <button type="button" class="btn btn-info" data-dismiss="modal">Cancel</button>
        </div>
      </div>
    </div>
	</div>
  </div>

	<br>
<footer><br>
	<div class="container">
		<div class="row">
			<div class="col-lg-3">
				<p class="time">Time Left <br>06:09:25</p>
			</div>
			<div class="col-lg-6 text-center">
				<input type="button"id="pass" value="PAUSE">   <a href="logoutfeedback.html"><button type="button">LOGOUT</button></a>

			
			</div>
		</div>
	</div>
</footer>
<script>
$(document).ready(function(){
	$(".iconbox").hide();
		$("#menubar").click(function(){
		$('#menubar').hide();
			$(".iconbox").show();
});
});

$(document).ready(function(){
	
		$(".close").click(function(){
		$('#menubar').show();
			$(".iconbox").hide();
});
});


$(document).ready(function(){
	
		$("#menubar").click(function(){
			$("#btn").hide();
			$(".close").click(function(){
		$('#btn').show();
});
});
});


$(document).ready(function(){
	
		$("#menubar").click(function(){
			$("#btn1").hide();
			$(".close").click(function(){
		$('#btn1').show();
});
});
});


	$(".call-card").hide();
		$("#callnow").click(function(){
		
			$(".call-card").show();


			
});



$('#commit').click(function(){
	var val=$('#commit').val();
	if(val=="SETCOMMIT"){
		$('#commit').val("COMMIT");
	}
	else{
		$('#commit').val("SETCOMMIT");
	}
})

$('#pass').click(function(){
	var val=$('#pass').val();
	if(val=="PAUSE"){
		$('#pass').val("RESUME");
	}
	else{
		$('#pass').val("PAUSE");
	}
})



</script>
<script>
	$(document).ready(function() {
		$.post( baseUrl + "getSession/",
		{},
		function(data, status) {
			dataObj=JSON.parse(data);
			if(dataObj.result=="fail") {
				window.location.href = baseUrl
			}else{
				emp_id = dataObj.description;
				getUserData(emp_id);
			}
		});
	})

	// $("#newLead").click(function () {
	// 		if (empFinal == '')
	// 			alert("You need to Login");
	// 		else {
	// 			fname = $("#fname").val();
	// 			$.post(baseUrl + "/",
	// 				{
	// 					fname: fname,
	// 				},
	// 				function (data, status) {
	// 					dataObj = JSON.parse(data);
	// 					alert(dataObj.description);
	// 					console.log(dataObj.description);
	// 					console.log(data);
	// 				});
	// 		}
	// 	});

	function getUserData(emp_id) {
		$.post( baseUrl + "getUserData/",
		{
			id: emp_id,
		},
		function(data, status) {
			dataObj=JSON.parse(data);
			if(dataObj.result=="fail") {
				alert("request failed")
			}else{
				console.log(dataObj)
				var fname = dataObj.description['fname']
				var lname = dataObj.description['lname']
				var loginTime = dataObj.description['loginTime']
				var d = new Date(loginTime);
				console.log("hello")
				console.log(d)
				//cuz jan starts with 0
				var date = d.getMonth() + 1

				$("#loginTime").text('Logged in at: ' + d.getHours() + ' : ' + d.getMinutes())
				$("#loginDate").text('DATE: ' + d.getDate() + '-' + date + '-' + d.getFullYear())
				$("#welcomeTag").text(fname + ' ' +lname);
				//To a change welcome
			}
			getCallTable(emp_id)
		});
	}

	$('#commit').click(function () {
			var val = $('#commit').val();

			if (val == "SETCOMMIT") {
				$('#commit').val("COMMIT");
			}
			else {
				$('#commit').val("SETCOMMIT");
			}
		})


	function getCallTable(emp_id) {
		// document.getElementById('dataTable').innerHTML=' ';
		$.post( baseUrl + "getAssignedLeads/",
		{
			id: emp_id,
		},
		function(data, status){
			dataObj = JSON.parse(data);
			if(dataObj.result == 'fail') {
				alert("Sorry No Data Assigned Yet");
			}else{
				// for (var i=0; i < dataObj.description.length; i++) {
				// 	console.log(dataObj.description[i]['fname'])
				// }
				var columns = addAllColumnHeaders(dataObj.description);
				for (var i = 0 ; i < dataObj.description.length ; i++) {
					var row$ = $('<tr/>');
					for (var colIndex = 0 ; colIndex < columns.length ; colIndex++) {
						var cellValue = dataObj.description[i][columns[colIndex]];
						if (cellValue == null) { 
							cellValue = ""; 
						}
							//arrange header
							// var orderedCellValue = orderCells(cellValue);
							row$.append($('<td/>').html(cellValue));
					}
					$("#main-table").append(row$);
					row$.append($('<td/>').html('<button type="button" class="btn btn-secondary callButton">CallNow</button>'));
					row$.append($('<td/>').html('<button type="button" class="btn btn-secondary callButton">SetCommit</button>'));
					row$.append($('<td/>').html('<button type="button" class="btn"data-toggle="modal" data-target="#myModal">Details</button>'));
				}
			}
		});
	}
			// $('#excelDataTable').DataTable();

	function orderCells(headers) {
		for (var header of headers) {
			console.log(header)
		}
	}

	function addAllColumnHeaders(myList) {
		var columnSet = [];
		var headerTr$ = $('<tr/>');

		for (var i = 0 ; i < dataObj.description.length ; i++) {
			var rowHash = dataObj.description[i];
			for (var key in rowHash) {
				// i'm not using alernative mobile number
				if ($.inArray(key, columnSet) == -1){
					columnSet.push(key);
					headerTr$.append($('<th />').html(key));
				}
			}
		}
		headerTr$.append($('<th />').html(' '));
		$("#main-table").append(headerTr$);

		return columnSet;
	} 

</script>


</body>
</html>
